function MSLOG_getCookie(name){var lims=document.cookie;var index=lims.indexOf("____MSLOG__"+name+"=");if(index==-1){return null;};index=lims.indexOf("=",index)+1;var endstr=lims.indexOf(";",index);if(endstr==-1){endstr=lims.length;};return unescape(lims.substring(index,endstr));};function MSLOG_setCookie(name,value,expireDate){var today=new Date();today.setDate(today.getDate()+parseInt(expireDate));if(expireDate!=0){document.cookie="____MSLOG__"+name+"="+escape(value)+"; path=/; expires="+today.toGMTString()+";";}else{document.cookie="____MSLOG__"+name+"="+escape(value)+"; path=/;";};};function MSLOG_delCookie(cookieName){var expireDate=new Date();expireDate.setDate(expireDate.getDate()-1);document.cookie="__MSLOG_"+cookieName+"= "+"; path=/; expires="+expireDate.toGMTString()+";";};function MSLOG_send(data){var img=new Image();imgsrc=MSLOG_server+"/ms.log?"+data+"r="+Math.random();img.src=imgsrc;};function MSLOG_sendB(){var img=new Image();imgsrc=MSLOG_server+"/ms.log?var="+MSLOG_var+"&code="+MSLOG_code+"&type=B"+"&r="+Math.random();img.src=imgsrc;};function MSLOG_encode64(input){var ua=navigator.userAgent.toLowerCase();if(ua.indexOf(" chrome/")>=0||ua.indexOf(" firefox/")>=0||ua.indexOf(' gecko/')>=0){var StringMaker=function(){this.str="";this.length=0;this.append=function(s){this.str+=s;this.length+=s.length;};this.prepend=function(s){this.str=s+this.str;this.length+=s.length;};this.toString=function(){return this.str;};};}else{var StringMaker=function(){this.parts=[];this.length=0;this.append=function(s){this.parts.push(s);this.length+=s.length;};this.prepend=function(s){this.parts.unshift(s);this.length+=s.length;};this.toString=function(){return this.parts.join('');};};};var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var output=new StringMaker();var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64;}else if(isNaN(chr3)){enc4=64;};output.append(keyStr.charAt(enc1)+keyStr.charAt(enc2)+keyStr.charAt(enc3)+keyStr.charAt(enc4));};return output.toString();};var MSLOG_data="";var MSLOG_var_url=document.URL;var MSLOG_var_referer=document.referrer;var MSLOG_var_domain=document.URL.split(/\/+/g)[1];if(MSLOG_var_domain.substring(0,4)=="www."){MSLOG_var_domain=MSLOG_var_domain.substring(4);};var MSLOG_var_initkey=MSLOG_getCookie("initkey");var MSLOG_var_initday=MSLOG_getCookie("initday");var MSLOG_var_orderday=MSLOG_getCookie("orderday");var MSLOG_d=new Date();var MSLOG_curdate=MSLOG_d.getFullYear()+("00"+(MSLOG_d.getMonth()+1)).slice(-2)+("00"+MSLOG_d.getDate()).slice(-2);var MSLOG_resolution=screen.width+"_"+screen.height;var MSLOG__rf="";var MSLOG__url="";eval("try { MSLOG__rf = top.document.referrer; } catch (_e) { MSLOG__rf = ''; };");eval("try { MSLOG__url = top.location.href; } catch (_e) { MSLOG__url = ''; };");MSLOG_data=MSLOG_data+"domain="+MSLOG_var_domain+"&";MSLOG_data=MSLOG_data+"url="+MSLOG_encode64(MSLOG_var_url)+"&";if(MSLOG_code)MSLOG_data=MSLOG_data+"&code="+MSLOG_code+"&";if(MSLOG_var)MSLOG_data=MSLOG_data+"&var="+MSLOG_var+"&";if(MSLOG_resolution)MSLOG_data=MSLOG_data+"&resolution="+MSLOG_resolution+"&";if(MSLOG_var_initkey==null){MSLOG_var_initkey=Math.random();MSLOG_setCookie("initkey",MSLOG_var_initkey,100);MSLOG_setCookie("initday",MSLOG_curdate,100);MSLOG_data=MSLOG_data+"init=ok&";}if(MSLOG_var_initkey!=null&&MSLOG_var_initday==null){MSLOG_setCookie("initday",MSLOG_curdate,0);MSLOG_data=MSLOG_data+"initday=ok&";}MSLOG_data=MSLOG_data+"initkey="+MSLOG_var_initkey+"&";if(MSLOG_var_initday!=null)MSLOG_data=MSLOG_data+"initday="+MSLOG_var_initday+"&";if(MSLOG_var_referer!=null&&MSLOG_var_referer!=MSLOG__url){MSLOG_data=MSLOG_data+"referer="+MSLOG_encode64(MSLOG_var_referer)+"&";}else{MSLOG_data=MSLOG_data+"_ref="+MSLOG_encode64(MSLOG__rf)+"&";MSLOG_data=MSLOG_data+"_url="+MSLOG_encode64(MSLOG__url)+"&";}if(MSLOG_var_url.indexOf("orderend.html")>0){MSLOG_setCookie("orderday",MSLOG_curdate,90);}if(MSLOG_var_orderday!=null){MSLOG_data=MSLOG_data+"orderday="+MSLOG_var_orderday+"&";}if(MSLOG_data.length>0){MSLOG_send(MSLOG_data);}